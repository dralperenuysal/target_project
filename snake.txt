
rule repeatmodeler:
    input:
        db = rules.build_database.output.db
    output:
        rm_output = directory("output/repeatmodeler/{genome}_rm")
    params:
        db_path = lambda wildcards: f"database/{wildcards.genome}_db",
        name = lambda wildcards: f"{wildcards.genome}_db",
        rm_output_path = lambda wildcards: f"output/repeatmodeler/{wildcards.genome}_rm"
    shell:
        """
        mkdir -p {params.rm_output_path}
        cd {params.rm_output_path}
        RepeatModeler -database {wildcards.genome}_db -engine ncbi -pa 20 > repeatmodeler.log 2>&1
        """